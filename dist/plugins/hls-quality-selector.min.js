/**
 * @eban5/videojs-hls-quality-selector
 * @version 1.1.6
 * @copyright 2022 Chris Boustead (chris@forgemotion.com), Esteban Amas (estebanamas@gmail.com), 
 * @license MIT
 */ !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).videojsHlsQualitySelector=e(t.videojs)}(this,function(t){"use strict";let e=t.getComponent("MenuButton"),i=t.getComponent("Menu"),l=t.getComponent("Component"),s=t.dom;class n extends e{constructor(t){super(t,{title:t.localize("Quality"),name:"QualityButton"})}createItems(){return[]}createMenu(){let t=new i(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var e;let n=s.createEl("li",{className:"vjs-menu-title",innerHTML:"string"!=typeof(e=this.options_.title)?e:e.charAt(0).toUpperCase()+e.slice(1),tabIndex:-1}),o=new l(this.player_,{el:n});this.hideThreshold_+=1,t.addItem(o)}if(this.items=this.createItems(),this.items)for(let u=0;u<this.items.length;u++)t.addItem(this.items[u]);return t}}let o=t.getComponent("MenuItem");class u extends o{constructor(t,e,i,l){super(t,{label:e.label,selectable:!0,selected:e.selected||!1}),this.item=e,this.qualityButton=i,this.plugin=l}handleClick(){for(let t=0;t<this.qualityButton.items.length;++t)this.qualityButton.items[t].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)}}let a={},h=t.registerPlugin||t.plugin;class r{constructor(t,e){this.player=t,this.config=e,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}getHls(){return this.player.tech({IWillNotUseThisInPlugins:!0}).vhs}bindPlayerEvents(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this,this.config.sortAscending,this.config.autoPlacement))}createQualityButton(){let t=this.player;this._qualityButton=new n(t);let e=t.controlBar.children().length-2,i=t.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||e);if(i.addClass("vjs-hls-quality-selector"),this.config.displayCurrentQuality)this.setButtonInnerText("auto");else{let l=` ${this.config.vjsIconClass||"vjs-icon-hd"}`;i.menuButton_.$(".vjs-icon-placeholder").className+=l}i.removeClass("vjs-hidden")}setButtonInnerText(t){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=t}getQualityMenuItem(t){let e=this.player;return new u(e,t,this._qualityButton,this)}onAddQualityLevel(t=!0,e="bottom"){let i=this.player,l=i.qualityLevels(),s=l.levels_||[],n=[],o=this.getQualityMenuItem.call(this,{label:i.localize("Auto"),value:"auto",selected:!0});for(let u=0;u<s.length;++u)if(s[u].height&&!n.filter(t=>t.item&&t.item.value===s[u].height).length){let a=this.getQualityMenuItem.call(this,{label:s[u].height+"p",value:s[u].height});n.push(a)}t?n.sort((t,e)=>"object"!=typeof t||"object"!=typeof e?-1:t.item.value-e.item.value):n.sort((t,e)=>"object"!=typeof t||"object"!=typeof e?-1:e.item.value-t.item.value),this._qualityButton&&(this._qualityButton.createItems=function(){return"top"===e?[o,...n]:[...n,o]},this._qualityButton.update())}setQuality(t){let e=this.player.qualityLevels();this._currentQuality=t,this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===t?t:`${t}p`);for(let i=0;i<e.length;++i){let l=e[i];l.enabled=l.height===t||"auto"===t}this._qualityButton.unpressButton()}getCurrentQuality(){return this._currentQuality||"auto"}}let c=(t,e)=>{t.addClass("vjs-hls-quality-selector"),t.hlsQualitySelector=new r(t,e)},y=function(e){this.ready(()=>{c(this,t.obj.merge(a,e))})};return h("hlsQualitySelector",y),y.VERSION="1.1.6",y});